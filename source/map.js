const SAVE = (
'camera:x=49097.44921504294,y=-24021.00364654508,scale=0.07841762235142195;entities:;id=0,source=PlaneUp1.png,x=28423.64375770222,y=-34727.34071170129,z=0,scale=0.737841722100403,rotation=-1.8156270819448517;id=1,source=Dot.png,x=-1112.3802432363698,y=-199.2064959521112,z=-1,scale=0.23723231804219377,rotation=0;id=2,source=Dot.png,x=1749.6945172441783,y=-3108.0204316813974,z=-1,scale=0.23723231804219377,rotation=0;id=3,source=Dot.png,x=2913.001842074364,y=-5554.100096704918,z=-1,scale=0.23723231804219377,rotation=0;id=4,source=Dot.png,x=377.09240916144836,y=-9080.660738594464,z=-1,scale=0.23723231804219377,rotation=0;id=5,source=Dot.png,x=4895.927197909934,y=-14041.452243939793,z=-1,scale=0.23723231804219377,rotation=0;id=6,source=Dot.png,x=11401.372208326726,y=-9452.53549976867,z=-1,scale=0.23723231804219377,rotation=0;id=7,source=Dot.png,x=15588.616551165489,y=-12403.648725203524,z=-1,scale=0.23723231804219377,rotation=0;id=8,source=Dot.png,x=21664.919932860415,y=-15431.120701850396,z=-1,scale=0.23723231804219377,rotation=0;id=9,source=Dot.png,x=26003.7900117144,y=-20350.361283296337,z=-1,scale=0.23723231804219377,rotation=0;id=12,source=Pond1.png,x=-1177.564913789029,y=-308.06717943119634,z=-5,scale=1.5786840794092463,rotation=118.49435449032491;id=13,source=Tree1.png,x=1566.7160883683457,y=589.9548254658055,z=-7,scale=1,rotation=-19.821886681411325;id=14,source=Tree1.png,x=1683.9372098427204,y=1195.1038067708375,z=-4,scale=1,rotation=193.8908518821929;id=15,source=Tree1.png,x=2158.303498829988,y=745.1727773789781,z=-6,scale=1.2762815625000004,rotation=38.92045649847701;id=16,source=Grass.png,x=3549.33542198885,y=3979.187271179728,z=0,scale=0.5376616644748713,rotation=-0.5122141295386463;id=17,source=Grass.png,x=3734.879718899445,y=3511.988121907439,z=0,scale=0.5403600876626365,rotation=-0.01592824771934131;id=18,source=Grass.png,x=4090.8380092510743,y=4150.862043331952,z=0,scale=0.6844921500592587,rotation=2.526193640019155;id=19,source=Grass.png,x=4196.728438948907,y=3587.9765559983357,z=0,scale=0.5927719850835456,rotation=1.9790791069477078;id=20,source=Pond2.png,x=7844.286906563942,y=1926.1437304119656,z=0,scale=2.4706590755578075,rotation=57.29262194564339;id=23,source=Pond1.png,x=8303.566530204793,y=1917.2091952872597,z=-5,scale=2.4490571565036325,rotation=111.04075932032961;id=21,source=Flower.png,x=9156.910460719591,y=1178.630596067073,z=1,scale=0.9900374375390625,rotation=-25.042312367405717;id=22,source=Flower.png,x=8092.0429376626835,y=698.4667477866519,z=1,scale=0.4357418792245978,rotation=-175.21671296022456;id=24,source=Flower.png,x=7878.25810605322,y=792.2743135950054,z=-2,scale=0.7277684917501196,rotation=-42.977137788908315;id=25,source=Grass.png,x=9011.760236873515,y=1134.6695768586892,z=-1,scale=1.4265764604953062,rotation=0;id=26,source=Grass.png,x=7937.677272059106,y=756.6268855464346,z=-3,scale=1.3383915334866219,rotation=0;id=27,source=Grass2.png,x=-1511.129012208867,y=-19.35294342198506,z=0,scale=0.5949894263083894,rotation=0;id=29,source=Grass2.png,x=-961.5828566403193,y=-691.720850784766,z=0,scale=0.4144645489046406,rotation=-0.20119743305977777;id=28,source=Grass2Flip.png,x=-950.7597037937785,y=-673.2513675962815,z=0,scale=0.35848592240854177,rotation=0;id=32,source=Grass.png,x=-957.9714445934276,y=-630.781366754072,z=0,scale=0.10935880111994853,rotation=17.30812307485352;id=33,source=Grass2Flip.png,x=4264.298496718716,y=3536.7656630861857,z=0,scale=0.5688000922764596,rotation=0;id=35,source=Grass2.png,x=3635.7109245539395,y=3519.248625932222,z=0,scale=0.3131749905703722,rotation=0;id=36,source=PondPurple1.png,x=11541.866994520096,y=-1921.006812210499,z=-2,scale=2.406619233691086,rotation=-34.67264739369941;id=34,source=Grass2.png,x=4026.4375225345593,y=4078.391860973453,z=0,scale=0.39969946630107756,rotation=0;id=37,source=Grass2Flip.png,x=3678.2085997477907,y=3972.553383512607,z=0,scale=0.35848592240854177,rotation=0;id=30,source=Grass.png,x=12070.449629024135,y=-1341.5503761828793,z=0,scale=0.7565439553286544,rotation=1.9790791069477078;id=31,source=Grass2Flip.png,x=12138.019686793945,y=-1392.761269095029,z=0,scale=0.7259490705207442,rotation=0;id=38,source=Tree1.png,x=16676.750848102427,y=-5622.5515776926595,z=0,scale=1.628894626777442,rotation=38.92045649847701;id=39,source=Tree1.png,x=16839.242768167212,y=-4824.130014816445,z=0,scale=1.1576250000000001,rotation=193.8908518821929;id=40,source=Tree1.png,x=17868.37611061313,y=-5335.460417666973,z=0,scale=1.3400956406250004,rotation=193.8908518821929;id=41,source=Banana.png,x=16666.65802714222,y=-5737.568257677025,z=0,scale=0.3972143184582181,rotation=162.62724209309116;id=42,source=Banana.png,x=17871.10373182547,y=-5092.935345311344,z=0,scale=0.3972143184582181,rotation=184.83088422281057;id=43,source=Banana.png,x=16909.809037946827,y=-5963.755244472004,z=0,scale=0.3972143184582181,rotation=329.6766863000335;id=44,source=Banana.png,x=16875.880989927573,y=-4680.144094410511,z=0,scale=0.3972143184582181,rotation=361.36010372959726;id=45,source=Dino.png,x=19378.64837676652,y=3452.846466818525,z=1,scale=1.7103393581163142,rotation=0;id=46,source=Dino2.png,x=19338.254046939044,y=1.5403443135897135,z=0,scale=1.9799315994393987,rotation=0;id=47,source=Dino.png,x=19555.725393547178,y=778.6686938840918,z=0,scale=1.7103393581163142,rotation=0;id=48,source=Dino.png,x=17755.388523147794,y=1401.125590564721,z=0,scale=1.7103393581163142,rotation=0;id=49,source=Dino2.png,x=18610.458290820145,y=2903.1471088402136,z=0,scale=2.0582167275721797,rotation=0;id=50,source=Dino.png,x=20806.621137989303,y=2979.8573294527287,z=0,scale=1.7103393581163142,rotation=0;id=51,source=Dino2.png,x=21345.505357788043,y=2619.694228029591,z=-1,scale=1.9799315994393987,rotation=0;id=52,source=Dino.png,x=21997.488662875287,y=955.059308272014,z=0,scale=1.6890667454431016,rotation=0;id=53,source=Rainbow.png,x=27255.982268698735,y=-11635.608284440239,z=0,scale=2.785962590401644,rotation=0;id=54,source=Cloud.png,x=28256.296572985022,y=-10900.401355570577,z=0,scale=1.5513282159785162,rotation=0;id=55,source=CloudFlip.png,x=26202.70630274263,y=-10916.320659991059,z=0,scale=1.628894626777442,rotation=0;id=56,source=Stone1.png,x=31962.012997458267,y=-5160.932836658841,z=0,scale=1,rotation=0.3308808567433968;id=57,source=Stone2.png,x=31731.57779157262,y=-6608.427306758083,z=0,scale=1,rotation=2.6002390595317966;id=58,source=Stone1.png,x=30452.699747734416,y=-5554.546460060139,z=0,scale=1,rotation=1.1115778698433467;id=59,source=Stone2.png,x=32002.146353246415,y=-6899.808834714477,z=0,scale=0.8005453409251319,rotation=89.7929991606716;id=60,source=Stone2.png,x=32342.091469195548,y=-6615.364962185617,z=0,scale=1,rotation=2.6002390595317966;id=61,source=Stone2.png,x=32568.226034084433,y=-5570.7488069644605,z=0,scale=1,rotation=2.6002390595317966;id=62,source=Stone2.png,x=31122.98373487356,y=-5073.9257099906745,z=0,scale=1,rotation=2.6002390595317966;id=63,source=Stone1.png,x=30986.89921565447,y=-6421.753388501792,z=0,scale=1,rotation=1.1115778698433467;id=10,source=Dot.png,x=21646.092069849055,y=-24000.082765447925,z=-1,scale=0.23723231804219377,rotation=0;id=11,source=Dot.png,x=21770.896958256402,y=-30802.036137440762,z=-1,scale=0.23723231804219377,rotation=0;id=72,source=Dot.png,x=28474.502788826565,y=-34742.92308564166,z=-1,scale=0.23723231804219377,rotation=0;id=77,source=SandPileLowHill.png,x=2342.515904570917,y=-2866.6365992498545,z=-2,scale=1.2762815625000004,rotation=0;id=78,source=SandPileLowHill.png,x=1234.9263155540941,y=-3651.559865409469,z=-1,scale=0.8912750154105562,rotation=0;id=73,source=Cat.png,x=3447.6353619461142,y=-5696.012652523015,z=-1,scale=0.9241991254845894,rotation=0;id=76,source=Grass2Flip.png,x=3730.944473266431,y=-5614.00051542656,z=0,scale=0.7080031617165252,rotation=0;id=80,source=Grass2.png,x=3228.4878653094315,y=-5576.156106370079,z=0,scale=0.5263319008506264,rotation=0;id=79,source=Grass2.png,x=3718.075406050164,y=-5576.03171806996,z=0,scale=0.4644329705032013,rotation=0;id=74,source=Star1.png,x=-65.37352293097251,y=-8748.626530937387,z=0,scale=0.5106402828411917,rotation=-18.260139512421944;id=75,source=Star1.png,x=861.7711312842711,y=-9403.769761588912,z=0,scale=0.5295035703672695,rotation=20.688011649182357;id=81,source=Star1.png,x=-226.77653463303437,y=-9463.411297046474,z=0,scale=0.8668342742879418,rotation=-11.099657541058225;id=82,source=Star1.png,x=1052.9187724333062,y=-8787.055819437881,z=0,scale=0.7921706789867907,rotation=27.32774043004029;id=83,source=Star1.png,x=-684.0850677888717,y=-9079.118412041598,z=0,scale=0.1713121671971585,rotation=-23.57688660795682;id=84,source=Star1.png,x=1268.1227880360586,y=-9413.757775123107,z=0,scale=0.1713121671971585,rotation=19.411164799085107;id=85,source=Rainbow.png,x=4986.513616010137,y=-15189.81058745894,z=0,scale=2.7651200642415366,rotation=0;id=86,source=Cloud.png,x=5986.827920296424,y=-14454.603658589278,z=0,scale=1.5513282159785162,rotation=0;id=87,source=CloudFlip.png,x=4030.1862122630987,y=-14497.453119178943,z=0,scale=1.628894626777442,rotation=0;id=88,source=Rainbow.png,x=4918.694258378729,y=-15886.233342426547,z=-1,scale=1.848264503279452,rotation=0;id=89,source=Rainbow.png,x=4897.150133443382,y=-16311.729809899656,z=-2,scale=1.1648676122068227,rotation=0;id=90,source=Pond2.png,x=11112.392265525206,y=-9307.08522023772,z=-2,scale=3.7955027749572934,rotation=55.18877092781839;id=91,source=Pond1.png,x=11827.360062241305,y=-9338.253509542883,z=-7,scale=3.762317239759156,rotation=107.90176753620234;id=93,source=Island2.png,x=11278.757561700399,y=-9388.452832390058,z=-2,scale=2.663223160228709,rotation=81.08711439107779;id=92,source=Grass2.png,x=12034.99514783825,y=-10406.97655345643,z=0,scale=0.9047241315891223,rotation=-0.20119743305977777;id=94,source=Grass2Flip.png,x=12053.854425138717,y=-10392.52513249491,z=0,scale=0.7825298103182647,rotation=0;id=95,source=Grass2.png,x=10439.962556447554,y=-8552.602570732504,z=0,scale=0.9924772974163424,rotation=0;id=96,source=Grass2.png,x=10957.307651883948,y=-10084.307404921985,z=0,scale=0.8424478271898834,rotation=0;id=97,source=Grass2Flip.png,x=12002.472881723608,y=-9108.487203026047,z=0,scale=0.7415448115028458,rotation=-4.713889484260323;id=98,source=Grass.png,x=10579.920288935129,y=-8513.386381115304,z=0,scale=1.064533319300981,rotation=1.9790791069477078;id=99,source=BirdLegs.png,x=16418.851783789854,y=-12540.679188696045,z=1,scale=0.7133398465897601,rotation=-0.7935937429115154;id=100,source=Grass2.png,x=16295.265152711985,y=-12268.344962846817,z=0,scale=0.5069361458982724,rotation=-0.20119743305977777;id=101,source=Grass2Flip.png,x=16515.156388561623,y=-12254.472729262128,z=1,scale=0.5652399549929698,rotation=0;id=102,source=BirdRond.png,x=16052.662433439224,y=-11965.858691219993,z=0,scale=0.7350918906249998,rotation=0;id=103,source=Grass2Flip.png,x=16145.458050253832,y=-11910.94340576013,z=0,scale=0.4685295034927467,rotation=0;id=104,source=BirdStand.png,x=14822.119384739553,y=-12210.261635518149,z=0,scale=0.6617618802108396,rotation=0;id=105,source=Grass2.png,x=14721.98193196944,y=-12085.275921324259,z=0,scale=0.44121132197804086,rotation=-0.20119743305977777;id=106,source=Grass2Flip.png,x=14901.261232964054,y=-12136.096206198059,z=-1,scale=0.4228478769022038,rotation=0;id=107,source=BirdBob.png,x=15197.13175422077,y=-13045.01376803459,z=0,scale=0.6302494097246091,rotation=2.850337092087663;id=108,source=Pond2.png,x=15087.49481484581,y=-12868.517670398407,z=-2,scale=0.8146620241588217,rotation=55.18877092781839;id=109,source=Grass2Flip.png,x=15264.319744003558,y=-12885.446733168823,z=1,scale=0.48462260641209737,rotation=0;id=110,source=Grass2.png,x=15028.857446042439,y=-12924.435702446714,z=3,scale=0.5069361458982724,rotation=-0.20119743305977777;id=111,source=Tree2.png,x=21660.97003149325,y=-16352.3233976289,z=0,scale=1.477455443789063,rotation=0;id=112,source=Tree1.png,x=21617.920350331326,y=-16891.738585492058,z=-1,scale=3.071523755917813,rotation=-1.951288965258096;id=113,source=Grass2Flip.png,x=21940.584538411877,y=-16133.687629113512,z=-1,scale=0.7499292016195676,rotation=0;id=114,source=Grass2.png,x=21395.45618868505,y=-16092.145102889477,z=-1,scale=0.7864243468313917,rotation=-0.20119743305977777;id=115,source=Tree2.png,x=25109.699521914747,y=-20616.666694833184,z=0,scale=1.1403687912635556,rotation=0;id=116,source=Tree2.png,x=26750.302426702005,y=-19930.87762104978,z=0,scale=1.2572565923680703,rotation=0;id=117,source=Tree2.png,x=26530.855319227165,y=-21120.21796375789,z=0,scale=0.7963620582406891,rotation=0;id=118,source=PondPurple1.png,x=27453.444306183614,y=-20750.435147837157,z=-1,scale=1.5513282159785162,rotation=25.027644147746916;id=119,source=Stone2.png,x=19700.34311147435,y=-24443.86346079667,z=0,scale=1,rotation=2.6002390595317966;id=120,source=Stone1.png,x=20140.154548773266,y=-24546.091703484246,z=0,scale=1,rotation=1.1115778698433467;id=121,source=Stone1.png,x=20967.000206297234,y=-24532.3181883043,z=0,scale=1,rotation=-12.451861378959011;id=122,source=Stone2.png,x=20647.33172224546,y=-24570.1131337072,z=0,scale=1,rotation=2.6002390595317966;id=123,source=Stone2.png,x=22490.685117527733,y=-24567.700915160247,z=0,scale=1,rotation=12.92623422057161;id=124,source=Stone2.png,x=23072.181986696134,y=-24537.88056289522,z=0,scale=1,rotation=-0.9777160632154442;id=125,source=Stone1.png,x=22793.15082244748,y=-24939.448989185807,z=-1,scale=1,rotation=-91.93513461663198;id=126,source=Grass2Flip.png,x=23212.709386142567,y=-24303.954256792254,z=2,scale=0.7499292016195676,rotation=0;id=127,source=Grass2.png,x=19562.87873587868,y=-24219.870874870234,z=0,scale=0.7864243468313917,rotation=-0.20119743305977777;id=128,source=Grass2Flip.png,x=21166.85064230531,y=-24349.30580530096,z=2,scale=0.5802809206878153,rotation=0;id=129,source=Stone1.png,x=21316.70596544175,y=-23069.957378437994,z=0,scale=1,rotation=-91.93513461663198;id=130,source=Stone2.png,x=21730.72982550901,y=-23224.68386128223,z=-1,scale=1,rotation=2.6002390595317966;id=132,source=Grass2.png,x=21024.206410048144,y=-22970.183760408083,z=0,scale=0.6085201683640193,rotation=-0.20119743305977777;id=64,source=Star1.png,x=22163.05234807929,y=-28560.872228375578,z=0,scale=0.1713121671971585,rotation=19.411164799085107;id=65,source=Star1.png,x=21155.486759533815,y=-28818.84070461744,z=0,scale=0.2930019420815028,rotation=-24.116983771715265;id=66,source=Star1.png,x=22051.019912842927,y=-29902.05340277959,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=67,source=Star1.png,x=21321.827764857233,y=-29484.362859675046,z=0,scale=0.2790494686490503,rotation=-20.78505894700626;id=68,source=Star1.png,x=22065.069716099348,y=-29284.145426906678,z=0,scale=0.24105342286927994,rotation=23.705603351528325;id=69,source=Star1.png,x=20852.765632095245,y=-29912.023763552195,z=0,scale=0.20667317843254884,rotation=-29.93714610298504;id=70,source=Robot1.png,x=20780.168967441972,y=-31411.252449001662,z=-1,scale=0.7737809374999999,rotation=0.4164377416926592;id=71,source=Robot2.png,x=22514.11631035251,y=-31713.435408178262,z=0,scale=0.7660720965790732,rotation=0;id=131,source=Robot3.png,x=21400.248699209664,y=-32026.83107652416,z=0,scale=0.7737809374999999,rotation=0;id=136,source=Stone1.png,x=20480.993707315545,y=-32140.823401775422,z=0,scale=1,rotation=-91.93513461663198;id=137,source=Stone2.png,x=20895.017567382805,y=-32295.549884619657,z=-1,scale=1,rotation=2.6002390595317966;id=138,source=Grass2.png,x=20188.49415192194,y=-32041.04978374551,z=0,scale=0.6085201683640193,rotation=-0.20119743305977777;id=133,source=Tree2.png,x=22145.503313360754,y=-32261.822514379845,z=-1,scale=0.7963620582406891,rotation=0;id=135,source=Tree1.png,x=22137.32499319105,y=-32532.35070942129,z=-2,scale=1.3317079407662733,rotation=-1.951288965258096;id=140,source=Grass2.png,x=27877.16073789191,y=-35271.03879892663,z=0,scale=0.6085201683640193,rotation=-0.20119743305977777;id=134,source=Stone2.png,x=28586.977768041666,y=-36411.03822078107,z=-1,scale=4.321942375150668,rotation=-2.1738422668432618;id=139,source=Grass2Flip.png,x=29368.27840281573,y=-35302.29482745462,z=2,scale=0.6397597150583165,rotation=0;id=141,source=Dot.png,x=42523.807672535106,y=-93403.79472839765,z=-1,scale=0.23723231804219377,rotation=0;id=144,source=Star1.png,x=32097.986125142015,y=-44189.37438529809,z=0,scale=0.2930019420815028,rotation=-0.37649559860242365;id=145,source=Star1.png,x=31212.06441836476,y=-42005.341001496505,z=0,scale=0.2790494686490503,rotation=3.1614509528912627;id=146,source=Star1.png,x=31053.622401733246,y=-41018.69589531076,z=0,scale=0.20667317843254884,rotation=-2.250697359337641;id=147,source=Star1.png,x=30459.723101457235,y=-39980.458228932504,z=0,scale=0.2930019420815028,rotation=8.483537840460977;id=148,source=Star1.png,x=32355.92550104696,y=-41287.78301189582,z=0,scale=0.2790494686490503,rotation=12.7518997671991;id=149,source=Star1.png,x=32229.706776556628,y=-41931.05880615843,z=0,scale=0.20667317843254884,rotation=-2.250697359337641;id=150,source=Star1.png,x=33513.948953034334,y=-41955.91964513863,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=151,source=Star1.png,x=33911.02128969682,y=-42968.429161489854,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=152,source=Star1.png,x=33626.25254729439,y=-43543.72936700229,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=153,source=Star1.png,x=34360.32646023563,y=-43445.018250884255,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=154,source=Star1.png,x=31632.521374570424,y=-43160.31701003912,z=0,scale=0.2930019420815028,rotation=18.996089315001235;id=155,source=Star1.png,x=32310.256227893606,y=-43583.82064797645,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=156,source=Star1.png,x=32535.68694056713,y=-45747.180392373215,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=157,source=Star1.png,x=32219.111225426637,y=-39847.79504294705,z=0,scale=0.2930019420815028,rotation=8.483537840460977;id=158,source=Star1.png,x=31239.626072280018,y=-38058.46465905108,z=0,scale=0.20667317843254884,rotation=14.201179459411385;id=159,source=Star1.png,x=32202.83328831545,y=-47160.75961914639,z=0,scale=0.2930019420815028,rotation=-20.566596276024168;id=160,source=Star1.png,x=32369.17429363887,y=-47826.281774204,z=0,scale=0.2790494686490503,rotation=-17.287667195197894;id=161,source=Star1.png,x=33645.9644330994,y=-47029.36105370848,z=0,scale=0.20667317843254884,rotation=-19.96730321824446;id=162,source=Star1.png,x=33234.2572639888,y=-45625.35459575117,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=163,source=Star1.png,x=34791.79059156946,y=-46902.484161257154,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=164,source=Star1.png,x=34548.25019796395,y=-47996.86970324561,z=0,scale=0.20667317843254884,rotation=-19.485303218244507;id=165,source=Star1.png,x=36175.33578271333,y=-47660.842744045134,z=0,scale=0.20823100992919116,rotation=5.904677657525584;id=166,source=Star1.png,x=36229.56471110415,y=-49034.24005857704,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=167,source=Star1.png,x=36395.90571642756,y=-49699.76221363465,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=168,source=Star1.png,x=37129.9796293688,y=-49601.05109751661,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=169,source=Star1.png,x=33810.759952554916,y=-48583.06404143829,z=0,scale=0.2930019420815028,rotation=-1.6055113624205857;id=170,source=Star1.png,x=34628.79964930093,y=-49649.63154506363,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=171,source=Star1.png,x=35275.14489224298,y=-50678.86047179244,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=172,source=Star1.png,x=34086.544899108114,y=-45823.38399048906,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=173,source=Star1.png,x=34811.50247737444,y=-44886.274972299536,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=174,source=Star1.png,x=35556.21701786386,y=-48722.21417650074,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=175,source=Star1.png,x=35828.51936253631,y=-50036.8534299964,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=176,source=Star1.png,x=34716.528319300014,y=-53647.552363598385,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=177,source=Star1.png,x=36728.93428080096,y=-50603.664468935975,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=178,source=Star1.png,x=34227.7543007331,y=-50652.244916482996,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=179,source=Star1.png,x=34874.09954367514,y=-51681.4738432118,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=180,source=Star1.png,x=35151.75533682829,y=-52693.778864257714,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=181,source=Star1.png,x=36455.152719673446,y=-52982.03020854078,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=182,source=Star1.png,x=37180.11029793977,y=-52044.921190351255,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=183,source=Star1.png,x=33410.94961732258,y=-49631.74470778172,z=0,scale=0.2790494686490503,rotation=-17.287667195197894;id=184,source=Star1.png,x=34596.19954740254,y=-50410.32029165564,z=0,scale=0.20667317843254884,rotation=-19.485303218244507;id=185,source=Star1.png,x=36223.28513215192,y=-50074.29333245516,z=0,scale=0.20823100992919116,rotation=5.904677657525584;id=186,source=Star1.png,x=36277.51406054274,y=-51447.69064698707,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=187,source=Star1.png,x=36443.85506586615,y=-52113.212802044676,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=188,source=Star1.png,x=37177.92897880739,y=-52014.50168592664,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=189,source=Star1.png,x=33858.709301993506,y=-50996.514629848316,z=0,scale=0.2930019420815028,rotation=-1.6055113624205857;id=190,source=Star1.png,x=34676.74899873952,y=-52063.08213347366,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=191,source=Star1.png,x=35323.09424168157,y=-53092.31106020247,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=192,source=Star1.png,x=37570.08969428549,y=-53453.21665444359,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=193,source=Star1.png,x=36495.09474491357,y=-53907.223188492135,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=194,source=Star1.png,x=34764.477668738604,y=-56061.00295200841,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=195,source=Star1.png,x=36776.88363023955,y=-53017.115057346,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=196,source=Star1.png,x=34275.70365017169,y=-53065.695504893025,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=197,source=Star1.png,x=34922.04889311373,y=-54094.92443162183,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=198,source=Star1.png,x=35199.70468626688,y=-55107.22945266774,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=199,source=Star1.png,x=36319.65423220071,y=-55811.29589394981,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=200,source=Star1.png,x=37228.05964737836,y=-54458.371778761284,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=201,source=Star1.png,x=35602.1443537389,y=-54349.940310758466,z=0,scale=0.20667317843254884,rotation=-2.250697359337641;id=202,source=Star1.png,x=37229.229938488264,y=-54013.91335155799,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=203,source=Star1.png,x=37283.45886687908,y=-55387.31066608989,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=204,source=Star1.png,x=37449.79987220249,y=-56052.8328211475,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=205,source=Star1.png,x=38183.87378514373,y=-55954.121705029465,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=206,source=Star1.png,x=35682.693805075876,y=-56002.70215257649,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=207,source=Star1.png,x=36329.03904801791,y=-57031.931079305294,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=208,source=Star1.png,x=36606.69484117106,y=-58044.236100351205,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=209,source=Star1.png,x=38635.04980228254,y=-57395.378426444746,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=210,source=Star1.png,x=34075.49125709996,y=-43745.17625090647,z=0,scale=0.20667317843254884,rotation=-2.250697359337641;id=211,source=Star1.png,x=34083.216874215155,y=-42745.71106708054,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=212,source=Star1.png,x=33616.682464996724,y=-44268.91701297947,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=213,source=Star1.png,x=33783.023470320135,y=-44934.43916803708,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=214,source=Star1.png,x=34517.097383261374,y=-44835.728051919046,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=215,source=Star1.png,x=32467.027150919348,y=-44974.53044901124,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=216,source=Star1.png,x=33113.3723938614,y=-46003.75937574005,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=217,source=Star1.png,x=33133.80264073934,y=-46980.98818593025,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=218,source=Star1.png,x=34968.27340040018,y=-46276.98477333433,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=219,source=Star1.png,x=35862.767825671675,y=-57950.99756440365,z=0,scale=0.2930019420815028,rotation=17.578464044625317;id=220,source=Star1.png,x=36249.24623528867,y=-59154.63337440111,z=0,scale=0.2790494686490503,rotation=-8.148764564188735;id=221,source=Star1.png,x=36941.526352706634,y=-58867.36207653299,z=0,scale=0.20667317843254884,rotation=2.705157074021443;id=222,source=Star1.png,x=37909.00890240641,y=-58390.9317108919,z=0,scale=0.2790494686490503,rotation=22.0747321269885;id=223,source=Star1.png,x=36590.63611557658,y=-60801.528719655245,z=0,scale=0.20667317843254884,rotation=11.747069589455169;id=224,source=Star1.png,x=38841.444345824435,y=-59059.06834413471,z=0,scale=0.20823100992919116,rotation=23.981071324678872;id=225,source=Star1.png,x=38895.67327421525,y=-60432.46565866661,z=0,scale=0.2930019420815028,rotation=23.655487474817754;id=226,source=Star1.png,x=39062.014279538664,y=-61097.98781372422,z=0,scale=0.2790494686490503,rotation=21.7328598130269;id=227,source=Star1.png,x=39796.0881924799,y=-60999.27669760618,z=0,scale=0.20667317843254884,rotation=21.211678125403104;id=228,source=Star1.png,x=36476.86851566602,y=-59981.28964152786,z=0,scale=0.2930019420815028,rotation=36.601034558813765;id=229,source=Star1.png,x=37294.90821241203,y=-61047.857145153204,z=0,scale=0.2790494686490503,rotation=43.47648167029444;id=230,source=Star1.png,x=36159.26434444959,y=-60124.11002157078,z=0,scale=0.20667317843254884,rotation=18.934894323769658;id=231,source=Star1.png,x=37289.37220050368,y=-57226.22254956519,z=0,scale=0.2930019420815028,rotation=20.329121952539815;id=232,source=Star1.png,x=38222.32558097497,y=-60120.43977659031,z=0,scale=0.2790494686490503,rotation=23.722546222660114;id=233,source=Star1.png,x=38494.627925647415,y=-61435.07903008597,z=0,scale=0.2930019420815028,rotation=25.96540341966735;id=234,source=Star1.png,x=39395.042843912066,y=-62001.89006902555,z=0,scale=0.20667317843254884,rotation=36.71342259553606;id=235,source=Star1.png,x=36893.8628638442,y=-62050.47051657257,z=0,scale=0.2790494686490503,rotation=67.92123842960956;id=236,source=Star1.png,x=37540.208106786245,y=-63079.699443301375,z=0,scale=0.20667317843254884,rotation=59.16590615356847;id=237,source=Star1.png,x=39846.218861050875,y=-63443.14679044083,z=0,scale=0.20667317843254884,rotation=19.04731168758112;id=238,source=Star1.png,x=36077.05818043368,y=-61029.97030787129,z=0,scale=0.2790494686490503,rotation=26.402979380748985;id=239,source=Star1.png,x=37262.308110513644,y=-61808.54589174521,z=0,scale=0.20667317843254884,rotation=17.006661636566164;id=240,source=Star1.png,x=38889.393695263025,y=-61472.518932544735,z=0,scale=0.20823100992919116,rotation=16.683698344877833;id=241,source=Star1.png,x=38943.62262365384,y=-62845.91624707664,z=0,scale=0.2930019420815028,rotation=28.91507952192875;id=242,source=Star1.png,x=39109.96362897725,y=-63511.43840213425,z=0,scale=0.2790494686490503,rotation=37.279269536408634;id=243,source=Star1.png,x=39844.03754191849,y=-63412.72728601621,z=0,scale=0.20667317843254884,rotation=26.471270172514092;id=244,source=Star1.png,x=36524.81786510461,y=-62394.74022993789,z=0,scale=0.2930019420815028,rotation=41.86062660592476;id=245,source=Star1.png,x=37342.85756185062,y=-63461.30773356323,z=0,scale=0.2790494686490503,rotation=48.73607371740543;id=246,source=Star1.png,x=35779.480956972504,y=-57401.98497582962,z=0,scale=0.20667317843254884,rotation=59.32394257217182;id=247,source=Star1.png,x=36057.13675012565,y=-58414.28999687553,z=0,scale=0.2930019420815028,rotation=27.357589217000342;id=248,source=Star1.png,x=38085.49171123713,y=-57765.43232296907,z=0,scale=0.20667317843254884,rotation=19.205348106184463;id=249,source=Star1.png,x=35554.42635884911,y=-54822.73022995112,z=0,scale=0.20667317843254884,rotation=-19.96730321824446;id=250,source=Star1.png,x=36792.991193879716,y=-54695.85333749979,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=251,source=Star1.png,x=36005.602375987815,y=-55700.01692994308,z=0,scale=0.20667317843254884,rotation=-19.485303218244507;id=252,source=Star1.png,x=37632.687960737196,y=-55363.9899707426,z=0,scale=0.20823100992919116,rotation=5.904677657525584;id=253,source=Star1.png,x=37686.91688912801,y=-56737.387285274504,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=254,source=Star1.png,x=37853.257894451424,y=-57402.909440332114,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=255,source=Star1.png,x=38587.331807392664,y=-57304.19832421408,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=256,source=Star1.png,x=36086.15182732479,y=-57352.7787717611,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=257,source=Star1.png,x=36732.49707026684,y=-58382.007698489906,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=258,source=Star1.png,x=37106.30787244828,y=-56354.02395969009,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=259,source=Star1.png,x=37285.871540560176,y=-57740.00065669387,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=260,source=Star1.png,x=36173.88049732388,y=-61350.69959029585,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=261,source=Star1.png,x=38186.28645882483,y=-58306.81169563344,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=262,source=Star1.png,x=35685.10647875696,y=-58355.39214318046,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=263,source=Star1.png,x=36331.451721699006,y=-59384.62106990927,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=264,source=Star1.png,x=36609.107514852156,y=-60396.92609095518,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=265,source=Star1.png,x=37912.50489769731,y=-60685.17743523825,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=266,source=Star1.png,x=38637.462475963635,y=-59748.06841704872,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=267,source=Star1.png,x=36053.551725426405,y=-58113.46751835311,z=0,scale=0.20667317843254884,rotation=-19.485303218244507;id=268,source=Star1.png,x=37680.637310175785,y=-57777.44055915263,z=0,scale=0.20823100992919116,rotation=5.904677657525584;id=269,source=Star1.png,x=37734.8662385666,y=-59150.83787368453,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=270,source=Star1.png,x=37901.207243890014,y=-59816.36002874214,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=271,source=Star1.png,x=38635.28115683125,y=-59717.64891262411,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=272,source=Star1.png,x=36134.10117676338,y=-59766.22936017113,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=273,source=Star1.png,x=36780.44641970543,y=-60795.458286899935,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=274,source=Star1.png,x=39027.441872309355,y=-61156.36388114106,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=275,source=Star1.png,x=37469.09079942503,y=-62429.46860638466,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=276,source=Star1.png,x=36221.82984676247,y=-63764.150178705924,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=277,source=Star1.png,x=38234.23580826342,y=-60720.26228404347,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=278,source=Star1.png,x=35733.05582819555,y=-60768.84273159049,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=279,source=Star1.png,x=36379.401071137596,y=-61798.0716583193,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=280,source=Star1.png,x=36657.056864290746,y=-62810.376679365225,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=281,source=Star1.png,x=37777.006410224574,y=-63514.44312064731,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=282,source=Star1.png,x=38685.411825402225,y=-62161.51900545875,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=283,source=Star1.png,x=37195.03767442818,y=-62402.6410106457,z=0,scale=0.20667317843254884,rotation=1.3278105666526558;id=284,source=Star1.png,x=38686.58211651213,y=-61717.060578255456,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=285,source=Star1.png,x=38740.81104490295,y=-63090.45789278738,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=286,source=Star1.png,x=38907.15205022636,y=-63755.980047845005,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=287,source=Star1.png,x=39641.2259631676,y=-63657.26893172696,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=288,source=Star1.png,x=37140.04598309974,y=-63705.84937927399,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=289,source=Star1.png,x=37786.39122604178,y=-64735.07830600278,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=290,source=Star1.png,x=37753.840171149044,y=-63710.00657245448,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=291,source=Star1.png,x=38031.495964302194,y=-64722.31159350039,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=292,source=Star1.png,x=40059.85092541367,y=-64073.45391959393,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=293,source=Star1.png,x=37287.56894880281,y=-64629.073057552836,z=0,scale=0.2930019420815028,rotation=17.578464044625317;id=294,source=Star1.png,x=37674.047358419804,y=-65832.7088675503,z=0,scale=0.2790494686490503,rotation=-8.148764564188735;id=295,source=Star1.png,x=38366.32747583777,y=-65545.43756968217,z=0,scale=0.20667317843254884,rotation=2.705157074021443;id=296,source=Star1.png,x=39333.81002553754,y=-65069.00720404108,z=0,scale=0.2790494686490503,rotation=22.0747321269885;id=297,source=Star1.png,x=38015.43723870771,y=-67479.60421280444,z=0,scale=0.20667317843254884,rotation=11.747069589455169;id=298,source=Star1.png,x=40266.24546895557,y=-65737.14383728389,z=0,scale=0.20823100992919116,rotation=23.981071324678872;id=299,source=Star1.png,x=40320.474397346385,y=-67110.54115181579,z=0,scale=0.2930019420815028,rotation=23.655487474817754;id=300,source=Star1.png,x=40486.815402669796,y=-67776.06330687342,z=0,scale=0.2790494686490503,rotation=21.7328598130269;id=301,source=Star1.png,x=41220.889315611035,y=-67677.35219075538,z=0,scale=0.20667317843254884,rotation=21.211678125403104;id=302,source=Star1.png,x=37901.66963879715,y=-66659.36513467705,z=0,scale=0.2930019420815028,rotation=36.601034558813765;id=303,source=Star1.png,x=38719.709335543164,y=-67725.9326383024,z=0,scale=0.2790494686490503,rotation=43.47648167029444;id=304,source=Star1.png,x=37584.06546758072,y=-66802.18551471997,z=0,scale=0.20667317843254884,rotation=18.934894323769658;id=305,source=Star1.png,x=38714.173323634815,y=-63904.29804271437,z=0,scale=0.2930019420815028,rotation=20.329121952539815;id=306,source=Star1.png,x=39647.1267041061,y=-66798.5152697395,z=0,scale=0.2790494686490503,rotation=23.722546222660114;id=307,source=Star1.png,x=39919.42904877855,y=-68113.15452323516,z=0,scale=0.2930019420815028,rotation=25.96540341966735;id=308,source=Star1.png,x=40819.8439670432,y=-68679.96556217474,z=0,scale=0.20667317843254884,rotation=36.71342259553606;id=309,source=Star1.png,x=38318.663986975334,y=-68728.54600972176,z=0,scale=0.2790494686490503,rotation=67.92123842960956;id=310,source=Star1.png,x=38965.00922991738,y=-69757.77493645057,z=0,scale=0.20667317843254884,rotation=59.16590615356847;id=311,source=Star1.png,x=41271.01998418201,y=-70121.22228359003,z=0,scale=0.20667317843254884,rotation=19.04731168758112;id=312,source=Star1.png,x=37501.859303564815,y=-67708.04580102049,z=0,scale=0.2790494686490503,rotation=26.402979380748985;id=313,source=Star1.png,x=38687.10923364478,y=-68486.6213848944,z=0,scale=0.20667317843254884,rotation=17.006661636566164;id=314,source=Star1.png,x=40314.19481839416,y=-68150.59442569393,z=0,scale=0.20823100992919116,rotation=16.683698344877833;id=315,source=Star1.png,x=40368.423746784974,y=-69523.99174022583,z=0,scale=0.2930019420815028,rotation=28.91507952192875;id=316,source=Star1.png,x=40534.764752108385,y=-70189.51389528347,z=0,scale=0.2790494686490503,rotation=37.279269536408634;id=317,source=Star1.png,x=41268.838665049625,y=-70090.80277916542,z=0,scale=0.20667317843254884,rotation=26.471270172514092;id=318,source=Star1.png,x=37949.61898823574,y=-69072.81572308709,z=0,scale=0.2930019420815028,rotation=41.86062660592476;id=319,source=Star1.png,x=38767.658684981754,y=-70139.38322671244,z=0,scale=0.2790494686490503,rotation=48.73607371740543;id=320,source=Star1.png,x=37204.282080103636,y=-64080.0604689788,z=0,scale=0.20667317843254884,rotation=59.32394257217182;id=321,source=Star1.png,x=37481.937873256786,y=-65092.36549002471,z=0,scale=0.2930019420815028,rotation=27.357589217000342;id=322,source=Star1.png,x=39510.292834368265,y=-64443.507816118254,z=0,scale=0.20667317843254884,rotation=19.205348106184463;id=323,source=Star1.png,x=39144.34704561329,y=-63306.69933390986,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=324,source=Star1.png,x=39278.05901758256,y=-64080.9849334813,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=325,source=Star1.png,x=40012.132930523796,y=-63982.27381736326,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=326,source=Star1.png,x=37510.952950455925,y=-64030.85426491028,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=327,source=Star1.png,x=38157.298193397975,y=-65060.08319163909,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=328,source=Star1.png,x=38710.67266369131,y=-64418.07614984305,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=329,source=Star1.png,x=37598.68162045501,y=-68028.77508344504,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=330,source=Star1.png,x=39611.08758195596,y=-64984.887188782624,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=331,source=Star1.png,x=37109.907601888095,y=-65033.467636329646,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=332,source=Star1.png,x=37756.25284483014,y=-66062.69656305846,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=333,source=Star1.png,x=38033.90863798329,y=-67075.00158410436,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=334,source=Star1.png,x=39337.306020828444,y=-67363.25292838745,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=335,source=Star1.png,x=40062.26359909477,y=-66426.14391019792,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=336,source=Star1.png,x=37478.35284855754,y=-64791.54301150229,z=0,scale=0.20667317843254884,rotation=-19.485303218244507;id=337,source=Star1.png,x=39105.43843330692,y=-64455.51605230181,z=0,scale=0.20823100992919116,rotation=5.904677657525584;id=338,source=Star1.png,x=39159.667361697735,y=-65828.91336683372,z=0,scale=0.2930019420815028,rotation=2.7909551985160332;id=339,source=Star1.png,x=39326.008367021146,y=-66494.43552189134,z=0,scale=0.2790494686490503,rotation=10.869151004809458;id=340,source=Star1.png,x=40060.082279962386,y=-66395.7244057733,z=0,scale=0.20667317843254884,rotation=5.873333068864685;id=341,source=Star1.png,x=37558.902299894515,y=-66444.30485332033,z=0,scale=0.2790494686490503,rotation=9.005099819117298;id=342,source=Star1.png,x=38205.247542836565,y=-67473.53378004913,z=0,scale=0.20667317843254884,rotation=3.7473330688647795;id=343,source=Star1.png,x=40452.24299544049,y=-67834.43937429025,z=0,scale=0.2790494686490503,rotation=-1.535218380890043;id=344,source=Star1.png,x=38893.89192255616,y=-69107.54409953386,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=345,source=Star1.png,x=37646.6309698936,y=-70442.22567185514,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=346,source=Star1.png,x=39659.03693139455,y=-67398.33777719266,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=347,source=Star1.png,x=37157.856951326685,y=-67446.91822473968,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=348,source=Star1.png,x=37804.20219426873,y=-68476.14715146848,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=349,source=Star1.png,x=38081.85798742188,y=-69488.45217251441,z=0,scale=0.2930019420815028,rotation=-10.389062836960749;id=350,source=Star1.png,x=39201.807533355706,y=-70192.51861379652,z=0,scale=0.2930019420815028,rotation=-6.1290628369608156;id=351,source=Star1.png,x=40110.21294853336,y=-68839.59449860794,z=0,scale=0.20667317843254884,rotation=-1.6049263994953347;id=352,source=Star1.png,x=38619.838797559314,y=-69080.7165037949,z=0,scale=0.20667317843254884,rotation=1.3278105666526558;id=353,source=Star1.png,x=40111.38323964326,y=-68395.13607140465,z=0,scale=0.20823100992919116,rotation=16.932963745656448;id=354,source=Star1.png,x=40165.61216803408,y=-69768.53338593658,z=0,scale=0.2930019420815028,rotation=15.380055875937831;id=355,source=Star1.png,x=40331.95317335749,y=-70434.05554099422,z=0,scale=0.2790494686490503,rotation=23.71726915289869;id=356,source=Star1.png,x=41066.02708629873,y=-70335.34442487618,z=0,scale=0.20667317843254884,rotation=15.988938927771652;id=357,source=Star1.png,x=38564.847106230874,y=-70383.9248724232,z=0,scale=0.2790494686490503,rotation=28.06371796720648;id=358,source=Star1.png,x=39211.19234917291,y=-71413.15379915199,z=0,scale=0.20667317843254884,rotation=21.8249389277717;id=142,source=PlaneUp1.png,x=0,y=0,z=0,scale=1,rotation=0;id=143,source=PlaneUp2.png,x=0,y=0,z=0,scale=1,rotation=0;id=359,source=Cloud.png,x=40468.26458332089,y=-19073.249735474903,z=0,scale=1.5513282159785162,rotation=0;id=360,source=CloudFlip.png,x=38636.69214423998,y=-17284.37892851803,z=0,scale=1.628894626777442,rotation=0;id=361,source=CloudFlip.png,x=42103.0350565678,y=-18129.47906003595,z=0,scale=1.628894626777442,rotation=0;id=363,source=Rainbow.png,x=44066.3113560346,y=-20929.84284267653,z=0,scale=2.785962590401644,rotation=0;id=364,source=Cloud.png,x=45066.62566032089,y=-20194.635913806866,z=0,scale=1.5513282159785162,rotation=0;id=365,source=CloudFlip.png,x=43013.03539007849,y=-20210.555218227346,z=0,scale=1.628894626777442,rotation=0;id=362,source=Cloud.png,x=48221.58953725581,y=-24044.59609659669,z=0,scale=1.5513282159785162,rotation=0;id=366,source=CloudFlip.png,x=46390.0170981749,y=-22255.725289639817,z=0,scale=1.628894626777442,rotation=0;id=367,source=CloudFlip.png,x=49856.36001050272,y=-23100.825421157733,z=0,scale=1.628894626777442,rotation=0;id=368,source=Star1.png,x=50097.46412204528,y=-25357.056972775044,z=0,scale=0.5106402828411917,rotation=-11.739624613906027;id=369,source=Star1.png,x=52919.636774834245,y=-28022.510301812123,z=0,scale=0.5295035703672695,rotation=7.687115372853113;id=370,source=Star1.png,x=50283.539904669,y=-26562.504261559076,z=0,scale=0.8668342742879418,rotation=-9.437661024535707;id=371,source=Star1.png,x=53572.0185705193,y=-27210.44557448053,z=0,scale=0.7921706789867907,rotation=3.9092357460625813;id=372,source=Star1.png,x=49774.21873517468,y=-25530.22910209035,z=0,scale=0.1713121671971585,rotation=-7.114627627667624;id=373,source=Star1.png,x=53246.42139340498,y=-26817.27001953075,z=0,scale=0.1713121671971585,rotation=14.951730630886694;id=374,source=PlaneUp1.png,x=0,y=0,z=0,scale=1,rotation=0;id=375,source=PlaneUp2.png,x=0,y=0,z=0,scale=1,rotation=0;id=376,source=moon.png,x=51767.371950213244,y=-26657.833011714894,z=0,scale=2.1557247450409127,rotation=0.06289120374500504;routes:;id=0,start=1,end=2,length=5000,type=snake,flip=true,slope=0.4;id=1,start=2,end=3,length=5000,type=single,flip=true,slope=0.1;id=2,start=3,end=4,length=5000,type=snake,flip=false,slope=0.1;id=3,start=4,end=5,length=5000,type=single,flip=false,slope=0.01;id=4,start=5,end=6,length=5000,type=snake,flip=true,slope=0.1;id=5,start=6,end=7,length=5000,type=single,flip=true,slope=0.15;id=6,start=7,end=8,length=5000,type=single,flip=false,slope=0.2;id=7,start=8,end=9,length=5000,type=single,flip=true,slope=0.1;id=8,start=9,end=10,length=5000,type=single,flip=false,slope=0.1;id=9,start=10,end=11,length=5000,type=snake,flip=true,slope=0.4;id=10,start=11,end=72,length=5000,type=snake,flip=true,slope=0.1;id=11,start=72,end=141,length=5000,type=single,flip=true,slope=0.4'

const stage = Stage.make()
const {canvas, context} = stage

const camera = {x: 0, y: 0, scale: 1, dx: 0, dy: 0, ddx: 0, ddy: 0}
const entities = new Map()
const freeEntityIds = new Set()
const layers = new Map()
const routes = new Map()
const freeRouteIds = new Set()

const selectedEntities = new Set()
const selectionBoxStart = [undefined, undefined]

const imageCache = new Map()

// Make an entity AND THEN place it on the map
const createEntity = (...args) => {
    const entity = makeEntity(...args)
    registerEntity(entity)
    return entity
}

// Get an entity id that is free to use (note: remember to remove it from the freeEntityIds list if you use it)
const getNewId = () => {
	findFreeEntityIds()
    if (freeEntityIds.size > 0) {
		return freeEntityIds.values().next().value
	}
    else return entities.size
}

// Place an entity on the map
const registerEntity = (entity) => {
    const id = getNewId()
	loadEntity(entity, id)
    return id
}

// Place an entity on the map in a specific id
const loadEntity = (entity, id) => {
	entity.id = id
	entities.set(id, entity)
	freeEntityIds.delete(id)
	const {z} = entity
	if (layers.get(z) === undefined) {
		layers.set(z, new Map())
	}
	const layer = layers.get(z)
	layer.set(id, entity)
}

const moveLayer = (entity, dz) => {
	const z = entity.z
	const layer = layers.get(z)
	const id = entity.id
	layer.delete(id)
	const nz = z + dz
	if (layers.get(nz) === undefined) {
		layers.set(nz, new Map())
	}
	const newLayer = layers.get(nz)
	newLayer.set(id, entity)
	entity.z = nz
}

// Remove an entity from the map
const unregisterEntity = (id) => {
	const entity = entities.get(id)
    freeEntityIds.add(id)
    entities.delete(id)

	const {z} = entity
	const layer = layers.get(z)
	layer.delete(id)
	if (layer.size === 0) layer.delete(z)
}

// Remove all entities
const unregisterAllEntities = () => {
	freeEntityIds.clear()
	entities.clear()
	layers.clear()
}

// Make an entity object
const makeEntity = (source, {x = 0, y = 0, z = 0, scale = 1, rotation = 0} = {}) => {
    const image = getImage(source)
    const entity = {id: undefined, source, image, x, y, z, scale, rotation}
    return entity
}

// Get an image element (make one if needed)
const getImage = (source) => {
	if (source === undefined) return new Image()
    const cachedImage = imageCache.get(source)
    if (cachedImage !== undefined) return cachedImage
    const image = new Image()
    image.src = `../images/${source}`
    imageCache.set(source, image)
    return image
}

on.load(() => {
    document.body.appendChild(canvas)
    document.body.style["margin"] = "0"
    canvas.style["background-color"] = "rgb(23, 29, 40)"
    trigger("resize")
    load(SAVE)
	
	flame1 = createEntity("PlaneUp1.png")
	flame2 = createEntity("PlaneUp2.png")
    
})

on.resize(() => {
    canvas.width = innerWidth
    canvas.height = innerHeight
})

let clipboard = []
on.keydown(e => {
	if (e.key === "Delete") {
		for (const entity of selectedEntities) {
			unregisterEntity(entity.id)
		}
		return
	}
	if (e.key === "=") {
		for (const entity of selectedEntities.values()) {
			moveLayer(entity, 1)
		}
		return
	}
	if (e.key === "-") {
		for (const entity of selectedEntities.values()) {
			moveLayer(entity, -1)
		}
		return
	}
	if (e.ctrlKey) {
		if (e.key === "p" || e.key === "d") {
			e.preventDefault()
			for (const entity of selectedEntities.values()) {
				print("Entity:", entity)
			}
			return
		}
		if (e.key === "c") {
			clipboard = []
			for (const entity of selectedEntities.values()) {
				clipboard.push({...entity})
			}
			return
		}
		if (e.key === "v") {
			selectedEntities.clear()
			for (const entity of clipboard) {
				entity.d
				const paste = createEntity(entity.source, {...entity})
				paste.d
				selectedEntities.add(paste)
			}
			return
		}
	}
})

const findFreeEntityIds = () => {
	const founds = [false].repeat(entities.size)
	for (const entity of entities.values()) {
		founds[entity.id] = true
	}
	const frees = []
	for (const i in founds) {
		if (!founds[i]) frees.push(i.as(Number))
	}
	freeEntityIds.clear()
	for (const free of frees) {
		freeEntityIds.add(free)
	}
}

on.mousewheel((e) => {
	e.preventDefault()
    const {deltaY} = e

	if (e.altKey) {
		for (const entity of selectedEntities) {
			const zoom = (-deltaY / 100) * (entity.scale - entity.scale * (1 - 0.05))
			entity.scale += zoom
			if (entity.scale < 0) entity.scale = 0
		}
		updateHovers()
		return
	}

	const zoom = (-deltaY / 100) * (camera.scale - camera.scale * (1 - 0.05))
    camera.scale += zoom
	camera.x += zoom
	camera.y += zoom
	if (camera.scale < 0) camera.scale = 0
	updateHovers()
	
}, {passive: false})

on.mousemove(e => {
	updateHovers()
	if (Mouse.Middle) {
		const {movementX, movementY} = e
		camera.x -= movementX / camera.scale
		camera.y -= movementY / camera.scale
	}
	else if (Mouse.Right) {
		const {movementX, movementY} = e

		if (e.altKey) {
			const [mx, my] = Mouse.position
			for (const entity of selectedEntities) {
				const space = getEntitySpace(entity)
				const [cx, cy] = space.center
				const [dx, dy] = [cx - mx, cy - my]
				entity.rotation += (movementY * -dx) / 2000
				entity.rotation += (movementX * dy) / 2000
			}
			updateHovers()
			return
		}

		for (const entity of selectedEntities.values()) {
			entity.x += movementX / camera.scale
			entity.y += movementY / camera.scale
		}
	}
})

on.mousedown(e => {
	if (e.button === 0) {
		const [mx, my] = Mouse.position
		selectionBoxStart[0] = mx
		selectionBoxStart[1] = my
		
	}
})

on.mouseup(e => {
	if (e.button === 0) {
		const [mx, my] = Mouse.position
		const [sx, sy] = selectionBoxStart
		if (sx !== undefined || sy !== undefined) {
			let hits = selectedEntities
			if (sx === mx && sy === my) {
				const hit = getHit(mx, my)
				if (hit !== undefined) {
					if ((e.shiftKey || e.ctrlKey) && selectedEntities.has(hit)) {
						selectedEntities.delete(hit)
					}
					else hits = new Set([hit])
				}
				else hits = new Set()
			}
			else {
				hits = getSelects([sx, sy], [mx, my])
			}
			
			if (!e.shiftKey && !e.ctrlKey) {
				selectedEntities.clear()
			}

			for (const hit of hits.values()) {
				selectedEntities.add(hit)
			}
			
			selectionBoxStart[0] = undefined
			selectionBoxStart[1] = undefined
		}
	}
})

on.contextmenu(e => e.preventDefault())

const getHits = (x, y) => {
	const hits = new Set()
	for (const entity of entities.values()) {
		const space = getEntitySpace(entity)
		const isCollision = isSpaceCollision([x, y], space)
		if (isCollision) hits.add(entity)
	}
	return hits
}

const getHit = (x, y) => {
	const hits = getHits(x, y)
	const hit = findTopHit(hits)
	return hit
}

const findTopHit = (hits) => {
	const dummy = {z: -Infinity}
	const hit = [...hits.values()].reduce((a, b) => a.z > b.z? a : b, dummy)
	if (dummy === hit) return undefined
	return hit
}

const updateHovers = () => {
	const [mx, my] = Mouse.position
	const [sx, sy] = selectionBoxStart
	if (sx === undefined || sy === undefined) {
		const hits = getHits(mx, my)
		const hit = findTopHit(hits)
		for (const entity of entities.values()) {
			if (hit === entity) {
				entity.highlight = true
				entity.hover = true
			}
			else if (hits.has(entity)) {
				entity.hover = true
				entity.highlight = false
			}
			else {
				entity.hover = false
				entity.highlight = false
			}
		}
		return
	}
	else {
		const hits = getSelects([sx, sy], [mx, my])
		for (const entity of entities.values()) {
			if (hits.has(entity)) {
				entity.hover = true
				entity.highlight = true
			}
			else {
				entity.hover = false
				entity.highlight = false
			}
		}
	}
}

const getSelects = ([sx, sy], [mx, my]) => {
	const hits = new Set()
	const selection = {rotation: 0, position: [sx, sy], center: [sx+(mx-sx)/2, sy+(my-sy)/2], dimensions: [mx-sx, my-sy]}
	for (const entity of entities.values()) {
		const space = getEntitySpace(entity)
		// TODO: replace with actual rectangle collision detection (instead of faking it with point collision detection)
		if (isSpaceCollision([mx, my], space)) {
			hits.add(entity)
			continue
		}
		if (isSpaceCollision([sx, sy], space)) {
			hits.add(entity)
			continue
		}
		if (isSpaceCollision(selection.center, space)) {
			hits.add(entity)
			continue
		}
		if (isSpaceCollision(space.center, selection)) {
			hits.add(entity)
			continue
		}
		for (const corner of space.corners) {
			const rcorner = rotate(corner, space.center, space.rotation)
			if (isSpaceCollision(rcorner, selection)) {
				hits.add(entity)
				break
			}
		}
	}
	return hits
}

// https://en.wikipedia.org/wiki/Polar_coordinate_system#Converting_between_polar_and_Cartesian_coordinates
const rotate = ([x, y], [ox, oy], radians) => {
	const [dx, dy] = [x - ox, y - oy]
	const d = Math.sqrt(dx**2 + dy**2)
	const angle = Math.atan2(dy,dx)
	const [rx, ry] = [d * Math.cos(radians + angle), d * Math.sin(radians + angle)]
	return [ox + rx, oy + ry]
}

const isSpaceCollision = ([x, y], {rotation, position, center, dimensions}) => {
	if (rotation !== 0) {
		const [rx, ry] = rotate([x, y], center, -rotation)
		return isSpaceCollision([rx, ry], {rotation: 0, position, center, dimensions})
	}

	const [px, py] = position
	const [width, height] = dimensions

	const left = Math.min(px, px + width)
	const right = Math.max(px, px + width)
	const top = Math.min(py, py + height)
	const bottom = Math.max(py, py + height)

	if (x < left) return false
	if (x > right) return false
	if (y < top) return false
	if (y > bottom) return false
	return true
}

const toRadians = (degrees) => degrees * Math.PI / 180
const toDegrees = (radians) => radians * 180 / Math.PI

const makeSpace = ({scale = 1, x = 0, y = 0, width = 100, height = 100, rotation = 0}) => {

	const w = scale * width * camera.scale
	const h = scale * height * camera.scale
	const dimensions = [w, h]

	const px = canvas.width/2 + (x - camera.x - (width * scale)/2) * camera.scale
	const py = canvas.height/2 + (y - camera.y - (height * scale)/2) * camera.scale
	const position = [px, py]

	const cx = px + w/2
	const cy = py + h/2
	const center = [cx, cy]

	const corners = [
		[px, py],
		[px + w, py],
		[px + w, py + h],
		[px, py + h],
	]
	
	return {dimensions, position, center, corners, rotation: toRadians(rotation)}
}

const getEntitySpace = (entity) => {
	const image = entity.image
	const [width, height] = [image.width, image.height]
	const {scale, x, y, rotation} = entity
	return makeSpace({scale, x, y, width, height, rotation})
}

const getRouteId = () => {
	if (freeRouteIds.size > 0) {
		return freeRouteIds.values().next().value
	}
	return routes.size
}

const deleteRoute = (id) => {
	freeRouteIds.add(id)
	routes.delete(id)
}

const deleteAllRoutes = () => {
	freeRouteIds.clear()
	routes.clear()
}

const createRoute = (start, end, {id = getRouteId(), length = 5000, type = "snake", flip = false, slope = 0.5} = {}) => {
	const route = {start, end, length, type, flip, slope, id}
	freeRouteIds.delete(id)
	routes.set(id, route)
	return route
}

const getCurve = ([ax, ay], [bx, by], {length = 5000, type = "snake", flip = false, slope = 0.5} = {}) => {
	const [dx, dy] = [bx - ax, by - ay]
	let [ix, iy] = [dx / length, dy / length]
	if (flip) [ix, iy] = [iy, ix]
	const points = []
	const previous = [ax, ay]
	for (const i of (0).to(length-1)) {
		const [px, py] = previous
		let [jx, jy] = [ix, iy]
		if (type === "snake") {
			const easing = Math.min(i, length-1 - (i))
			const racing  = (length/2 - 1) - easing
			
			const ease = (easing * slope + racing) / (1 + slope)
			const race = (racing * slope + easing) / (1 + slope) 

			jx = ix * 2 * (race) / (length/2 - 1)
			jy = iy * 2 * (ease) / (length/2 - 1)
		}
		else if (type === "single") {

			const easing = length-1-i
			const racing = i

			const ease = (easing * slope + racing) / (1 + slope)
			const race = (racing * slope + easing) / (1 + slope) 

			jx = ix * 2 * ease / (length - 1)
			jy = iy * 2 * race / (length - 1)
		}
		if (flip) [jx, jy] = [jy, jx]
		const [x, y] = [px + jx, py + jy]
		points.push([x, y])
		previous[0] = x
		previous[1] = y
	}
	return points
}

let flightDelay = 0
let cameraStart = undefined

const animateRoute = (route, plane = 0) => {
	const r = routes.get(route)
	const p = entities.get(plane)
	p.flying = true
	r.flightProgress = 0
	r.flying = true
	cameraStart = {...camera}
	flightDelay = 200
}

const MAX_SPEED = 2
let prevRoute = undefined
let prevPlaneRot = undefined
let flameTicker = 0
const FLAME_DURATION = 100
stage.draw = () => {

	camera.x += camera.dx
	camera.y += camera.dy

	camera.dx += camera.ddx
	camera.dy += camera.ddy

    context.clearRect(0, 0, canvas.width, canvas.height);

	// Non-Plane Images
	const zs = [...layers.keys()].sort((a, b) => a - b)
	for (const z of zs) {
		const layer = layers.get(z)
		for (const entity of layer.values()) {

			if (entity.source === "Plane.png" || entity.source === "PlaneUp1.png" || entity.source === "PlaneUp2.png" || entity.source === "PlaneFull.gif") continue

			const {image} = entity
			let {dimensions, rotation, center} = getEntitySpace(entity)

			const [width, height] = dimensions
			const [cx, cy] = center
			const [ox, oy] = [-width/2, -height/2]

			context.translate(cx, cy)
			context.rotate(rotation)
			context.drawImage(image, ox, oy, width, height)
			context.rotate(-rotation)
			context.translate(-(cx), -(cy))
		}
	}

	// Routes
	context.lineWidth = 26 * camera.scale
	context.setLineDash([100 * camera.scale, 50 * camera.scale])
	context.strokeStyle = "rgba(224, 224, 224)"

	let currentFrame = undefined

	for (const route of routes.values()) {
		const {start, end, slope, length, type, flip} = route
		const s = entities.get(start)
		const e = entities.get(end)
		if (s === undefined || e === undefined) {
			deleteRoute(route.id)
			continue
		}
		const [sx, sy] = getEntitySpace(s).center
		const [ex, ey] = getEntitySpace(e).center
		const curve = getCurve([sx, sy], [ex, ey], {slope, length, type, flip})

		context.beginPath()
		context.moveTo(sx, sy)
		let i = -1
		let previous = [sx, sy]

		let DX = 0
		let DY = 0

		for (const [x, y] of curve) {
			i++

			//DX += x
			//DY += y

			if (route.flying && i > route.flightProgress) {
				currentFrame = [previous, [x, y]]
				break
			}
			context.lineTo(x, y, ex, ey)
			previous = [x, y]
		}
		if (route.flying && flightDelay <= 0) {

			prevRoute = route
			const easing = Math.min(route.flightProgress + route.length / 8, (route.length-1) - (route.flightProgress)) * MAX_SPEED
			
			route.flightProgress += MAX_SPEED
			let penalty = MAX_SPEED - (easing / (route.length/3))
			penalty
			if (penalty > MAX_SPEED - MAX_SPEED * 0.06) penalty = MAX_SPEED - MAX_SPEED * 0.06
			route.flightProgress -= penalty
			
			if (route.flightProgress >= length) {
				route.flying = false
			}
		}
		flightDelay--
		context.stroke()
	}

	// Plane Images
	for (const z of zs) {
		const layer = layers.get(z)
		for (const entity of layer.values()) {

			if (entity === flame1 || entity === flame2) continue
			if (entity.source !== "Plane.png" && entity.source !== "PlaneUp1.png" && entity.source !== "PlaneUp2.png" && entity.source !== "PlaneFull.gif") continue


			if (entity.source === "PlaneUp1.png" || entity.source === "PlaneUp2.png") {
				flameTicker++
				if (flameTicker >= FLAME_DURATION) {
					flameTicker = 0
					entity.source = entity.source === "PlaneUp1.png"? "PlaneUp2.png" : "PlaneUp1.png"
					entity.image = entity.source === "PlaneUp1.png"? flame1.image : flame2.image
				}
			}

			const {image} = entity
			let {dimensions, rotation, center} = getEntitySpace(entity)

			if (entity.flying) {
				
				// END
				if (currentFrame === undefined) {
					const end = entities.get(prevRoute.end)
					entity.x = end.x
					entity.y = end.y
					entity.rotation = toDegrees(prevPlaneRot)
					entity.flying = false
					let newSpace = getEntitySpace(entity)
					dimensions = newSpace.dimensions
					rotation = newSpace.rotation
					center = newSpace.center
				}

				// DURING
				else {
					const [prev, next] = currentFrame
					const [px, py] = prev
					const [nx, ny] = next
					const [dx, dy] = [nx - px, ny - py]
					rotation = Math.atan2(dy, dx)
					center = next
					prevPlaneRot = rotation

				}
			}

			const [width, height] = dimensions
			const [cx, cy] = center
			const [ox, oy] = [-width/2, -height/2]


			context.translate(cx, cy)
			context.rotate(rotation)
			context.drawImage(image, ox, oy, width, height)
			context.rotate(-rotation)
			context.translate(-(cx), -(cy))
		}
	}

	// Hovers
	context.lineWidth = 5 * camera.scale
	context.setLineDash([])
	for (const entity of entities.values()) {
        let {dimensions, rotation, center} = getEntitySpace(entity)
		
		if (entity.flying) {
			const [prev, next] = currentFrame
			const [px, py] = prev
			const [nx, ny] = next
			const [dx, dy] = [nx - px, ny - py]
			rotation = Math.atan2(dy, dx)
			center = next
		}

		const [width, height] = dimensions
		const [cx, cy] = center
		const [ox, oy] = [-width/2, -height/2]

		context.translate(cx, cy)
		context.rotate(rotation)
		
		if (entity.highlight) {
			context.fillStyle = "rgba(0, 128, 255, 25%)"
			context.fillRect(ox, oy, width, height)
		}

		if (selectedEntities.has(entity)) {
			context.strokeStyle = "rgba(0, 255, 128)"
			context.strokeRect(ox, oy, width, height)
		}
		else if (entity.hover) {
			context.strokeStyle = "rgba(0, 128, 255)"
			context.strokeRect(ox, oy, width, height)
		}

		context.rotate(-rotation)
		context.translate(-(cx), -(cy))

    }

	if (Mouse.Left) {
		const [sx, sy] = selectionBoxStart
		if (sx !== undefined && sy !== undefined) {
			const [mx, my] = Mouse.position
			context.strokeStyle = "rgba(0, 128, 255)"
			context.strokeRect(sx, sy, mx - sx, my - sy)
			context.fillStyle = "rgba(0, 128, 255, 25%)"
			context.fillRect(sx, sy, mx - sx, my - sy)
		}
	}
}

// Save the map state to a string
const save = () => {
    const lines = []
    lines.push(`camera:x=${camera.x},y=${camera.y},scale=${camera.scale}`)
    lines.push(`entities:`)
    for (const entity of entities.values()) {
        lines.push(`id=${entity.id},source=${entity.source},x=${entity.x},y=${entity.y},z=${entity.z},scale=${entity.scale},rotation=${entity.rotation}`)
    }
	lines.push(`routes:`)
    for (const route of routes.values()) {
        lines.push(`id=${route.id},start=${route.start},end=${route.end},length=${route.length},type=${route.type},flip=${route.flip},slope=${route.slope}`)
    }
    return lines.join(`;`)
}

const Load = MotherTode(`
	:: Camera ";" Entities ";" Routes EOF
	Camera (
		:: "camera:x=" Number ",y=" Number ",scale=" Number
		>> ([c, x, _1, y, _2, scale]) => {
			camera.x = x.output
			camera.y = y.output
			camera.scale = scale.output
		}
	)
	Entities :: "entities:" { Entity }
	Entity (
		:: ";id=" Number ",source=" String ",x=" Number ",y=" Number ",z=" Number ",scale=" Number ",rotation=" Number
		?? ([_1, id, _2, source, _3, x, _4, y, _5, z, _6, scale, _7, rotation]) => {
			const entity = makeEntity(source.output, {x: x.output, y: y.output, z: z.output, scale: scale.output, rotation: rotation.output})
			loadEntity(entity, id.output)
			return true
		}
	)
	Routes :: "routes:" { Route }
	Route (
		:: ";id=" Number ",start=" Number ",end=" Number ",length=" Number ",type=" String ",flip=" Boolean ",slope=" Number
		?? ([_1, id, _2, start, _3, end, _4, length, _5, type, _6, flip, _7, slope]) => {
			const route = createRoute(start.output, end.output, {id: id.output, length: length.output, type: type.output, flip: flip.output, slope: slope.output})
			return true
		}
	)
	String :: /[^,]/+
	Number :: "-"? /[0-9.]/+ >> (n) => n.output.as(Number)
	Boolean :: True | False
	True :: "true" >> true
	False :: "false" >> false
`)

// Load a map state
const load = (save) => {
	MotherTode.Term.resetCache()
	unregisterAllEntities()
	const result = Load(save)
	if (!result.success) {
		result.smartLog()
		result.log()
	}
	return result
}
